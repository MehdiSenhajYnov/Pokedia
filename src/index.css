@import "tailwindcss";

@custom-variant dark (&:is(.dark *));

/* ─── Default theme (dark-first design) ─── */
@theme {
  --font-heading: "Space Grotesk", system-ui, sans-serif;
  --font-body: "Outfit", system-ui, sans-serif;
  --font-mono: "JetBrains Mono", ui-monospace, monospace;

  /* Background layers — deep blue-night */
  --color-background: oklch(0.18 0.035 275);
  --color-foreground: oklch(0.92 0.01 260);

  /* Cards sit one step above the background */
  --color-card: oklch(0.22 0.04 275);
  --color-card-foreground: oklch(0.92 0.01 260);

  /* Popovers / dropdowns */
  --color-popover: oklch(0.23 0.04 275);
  --color-popover-foreground: oklch(0.92 0.01 260);

  /* Primary accent — coral chaud (Persona 5 style) */
  --color-primary: oklch(0.70 0.18 15);
  --color-primary-foreground: oklch(1 0 0);

  /* Secondary — muted surface */
  --color-secondary: oklch(0.25 0.04 275);
  --color-secondary-foreground: oklch(0.85 0.01 260);

  /* Muted — subtle backgrounds, disabled states */
  --color-muted: oklch(0.23 0.03 275);
  --color-muted-foreground: oklch(0.58 0.03 265);

  /* Accent — hover highlights */
  --color-accent: oklch(0.27 0.045 275);
  --color-accent-foreground: oklch(0.92 0.01 260);

  /* Secondary accent — teal électrique */
  --color-secondary-accent: oklch(0.72 0.14 195);
  --color-glow-secondary: oklch(0.72 0.14 195 / 0.25);

  /* Destructive */
  --color-destructive: oklch(0.55 0.22 25);
  --color-destructive-foreground: oklch(1 0 0);

  /* Success */
  --color-success: oklch(0.60 0.17 145);
  --color-success-foreground: oklch(1 0 0);

  /* Warning */
  --color-warning: oklch(0.75 0.16 70);
  --color-warning-foreground: oklch(0.15 0.02 70);

  /* Borders & inputs */
  --color-border: oklch(0.30 0.035 275 / 0.5);
  --color-input: oklch(0.30 0.035 275 / 0.5);
  --color-ring: oklch(0.70 0.18 15);

  /* Radius */
  --radius: 0.625rem;

  /* Sidebar */
  --color-sidebar: oklch(0.16 0.04 280);
  --color-sidebar-foreground: oklch(0.85 0.01 260);
  --color-sidebar-primary: oklch(0.70 0.18 15);
  --color-sidebar-primary-foreground: oklch(1 0 0);
  --color-sidebar-accent: oklch(0.24 0.045 280);
  --color-sidebar-accent-foreground: oklch(0.92 0.01 260);
  --color-sidebar-border: oklch(0.22 0.02 270 / 0.5);
  --color-sidebar-ring: oklch(0.70 0.18 15);

  /* Chart palette */
  --color-chart-1: oklch(0.70 0.18 15);
  --color-chart-2: oklch(0.72 0.14 195);
  --color-chart-3: oklch(0.75 0.18 65);
  --color-chart-4: oklch(0.65 0.20 290);
  --color-chart-5: oklch(0.68 0.22 340);

  /* Custom glow tokens */
  --color-glow-primary: oklch(0.70 0.18 15 / 0.3);

  /* Mesh gradient blobs — dark: deep indigo/violet/blue */
  --color-mesh-1: oklch(0.25 0.08 280);
  --color-mesh-2: oklch(0.22 0.07 320);
  --color-mesh-3: oklch(0.20 0.06 240);
}

/* ─── Light mode overrides ─── */
@layer base {
  .light {
    --color-background: oklch(0.97 0.01 270);
    --color-foreground: oklch(0.18 0.02 265);

    --color-card: oklch(0.99 0.005 270);
    --color-card-foreground: oklch(0.18 0.02 265);

    --color-popover: oklch(0.99 0.005 270);
    --color-popover-foreground: oklch(0.18 0.02 265);

    --color-primary: oklch(0.62 0.20 15);
    --color-primary-foreground: oklch(1 0 0);

    --color-secondary: oklch(0.94 0.015 270);
    --color-secondary-foreground: oklch(0.30 0.02 265);

    --color-muted: oklch(0.94 0.015 270);
    --color-muted-foreground: oklch(0.50 0.01 260);

    --color-accent: oklch(0.93 0.02 270);
    --color-accent-foreground: oklch(0.18 0.02 265);

    --color-destructive: oklch(0.55 0.22 25);
    --color-destructive-foreground: oklch(1 0 0);

    --color-border: oklch(0.87 0.015 270 / 0.6);
    --color-input: oklch(0.87 0.015 270 / 0.6);

    --color-secondary-accent: oklch(0.55 0.14 195);
    --color-glow-secondary: oklch(0.55 0.14 195 / 0.25);
    --color-ring: oklch(0.62 0.20 15);

    --color-sidebar: oklch(0.96 0.01 270);
    --color-sidebar-foreground: oklch(0.30 0.02 265);
    --color-sidebar-primary: oklch(0.62 0.20 15);
    --color-sidebar-primary-foreground: oklch(1 0 0);
    --color-sidebar-accent: oklch(0.94 0.015 270);
    --color-sidebar-accent-foreground: oklch(0.18 0.02 265);
    --color-sidebar-border: oklch(0.87 0.015 270 / 0.6);
    --color-sidebar-ring: oklch(0.62 0.20 15);

    --color-chart-1: oklch(0.62 0.20 15);
    --color-chart-2: oklch(0.55 0.14 195);
    --color-chart-3: oklch(0.65 0.18 65);
    --color-chart-4: oklch(0.52 0.20 290);
    --color-chart-5: oklch(0.55 0.22 340);

    --color-glow-primary: oklch(0.62 0.20 15 / 0.2);

    /* Mesh gradient blobs — light: peach/lavender/mint */
    --color-mesh-1: oklch(0.94 0.04 30);
    --color-mesh-2: oklch(0.93 0.05 290);
    --color-mesh-3: oklch(0.95 0.03 170);

    --glass-highlight: rgba(255,255,255,0.35);
    --glass-highlight-side: rgba(255,255,255,0.18);
    --text-glass-shadow: 0 1px 2px rgba(255,255,255,0.6);
  }
}

/* ─── Base styles ─── */
@layer base {
  * {
    @apply border-border;
  }

  :root {
    --glass-highlight: rgba(255,255,255,0.12);
    --glass-highlight-side: rgba(255,255,255,0.06);
    --text-glass-shadow: 0 1px 3px rgba(0,0,0,0.4);
  }

  body {
    @apply bg-background text-foreground antialiased;
    font-family: var(--font-body);
    margin: 0;
    background-image: radial-gradient(
      circle,
      color-mix(in oklch, var(--color-foreground) 3%, transparent) 1px,
      transparent 1px
    );
    background-size: 24px 24px;
  }

  /* Smooth color transitions only during theme switching.
     The .theme-transitioning class is added/removed by the theme toggle. */
  .theme-transitioning *,
  .theme-transitioning *::before,
  .theme-transitioning *::after {
    transition:
      background-color 0.2s ease,
      border-color 0.2s ease,
      color 0.15s ease !important;
  }
}

/* ─── Typography utility classes ─── */
@layer utilities {
  .font-heading {
    font-family: var(--font-heading);
  }
  .font-body {
    font-family: var(--font-body);
  }
  .font-mono {
    font-family: var(--font-mono);
  }
}

/* ─── Glassmorphism utilities — iOS 26 depth hierarchy ─── */
@layer utilities {
  /* Level 1 — fixed chrome: sidebar, header, sticky headers */
  .glass-heavy {
    background: color-mix(in oklch, var(--color-card) 48%, transparent);
    backdrop-filter: blur(24px) saturate(1.5);
    -webkit-backdrop-filter: blur(24px) saturate(1.5);
    will-change: transform;
    transform: translateZ(0);
  }
  /* Level 2 — cards, panels, dialogs */
  .glass {
    background: color-mix(in oklch, var(--color-card) 55%, transparent);
    backdrop-filter: blur(14px) saturate(1.3);
    -webkit-backdrop-filter: blur(14px) saturate(1.3);
  }
  /* Level 3 — badges, pills, small elements */
  .glass-light {
    background: color-mix(in oklch, var(--color-card) 72%, transparent);
    backdrop-filter: blur(8px) saturate(1.2);
    -webkit-backdrop-filter: blur(8px) saturate(1.2);
  }
  /* Backward compat alias */
  .glass-subtle {
    background: color-mix(in oklch, var(--color-card) 72%, transparent);
    backdrop-filter: blur(8px) saturate(1.2);
    -webkit-backdrop-filter: blur(8px) saturate(1.2);
  }
  /* Flat variants — same look as glass but without backdrop-filter.
     Use these when many elements are visible at once (grids, lists). */
  .glass-flat {
    background: color-mix(in oklch, var(--color-card) 65%, transparent);
  }
  .glass-light-flat {
    background: color-mix(in oklch, var(--color-card) 80%, transparent);
  }
  /* Luminous glass edge — opt-in on surfaces without conflicting box-shadow */
  .glass-edge {
    box-shadow:
      inset 0 0.5px 0 0 var(--glass-highlight),
      inset 0.5px 0 0 0 var(--glass-highlight-side);
  }
  /* Colored warm shadow */
  .shadow-warm {
    box-shadow:
      0 4px 24px -4px color-mix(in oklch, var(--color-primary) 18%, transparent),
      0 2px 8px -2px color-mix(in oklch, var(--color-primary) 10%, transparent);
  }
  /* Deep colored shadow for elevated glass surfaces */
  .shadow-glass {
    box-shadow:
      0 8px 32px -8px color-mix(in oklch, var(--shadow-tint, var(--color-primary)) 20%, rgba(0,0,0,0.3)),
      0 2px 8px -2px color-mix(in oklch, var(--shadow-tint, var(--color-primary)) 12%, rgba(0,0,0,0.2));
  }
  .glow-primary {
    box-shadow: 0 0 20px var(--color-glow-primary);
  }
  /* Text readability on glass surfaces */
  .text-glass {
    text-shadow: var(--text-glass-shadow);
  }
  /* Hide scrollbar completely */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }
}

/* ─── Mesh gradient — living background ─── */
.mesh-blob {
  position: absolute;
  border-radius: 50%;
  filter: blur(100px);
  opacity: 0.6;
  will-change: transform;
}
.mesh-blob-1 {
  width: 50vmax;
  height: 50vmax;
  top: -20%;
  left: -15%;
  background: var(--color-mesh-1);
  animation: mesh-drift-1 30s ease-in-out infinite;
}
.mesh-blob-2 {
  width: 45vmax;
  height: 45vmax;
  bottom: -15%;
  right: -10%;
  background: var(--color-mesh-2);
  animation: mesh-drift-2 25s ease-in-out infinite;
}
.mesh-blob-3 {
  width: 40vmax;
  height: 40vmax;
  top: 40%;
  left: 30%;
  background: var(--mesh-accent, var(--color-mesh-3));
  animation: mesh-drift-3 35s ease-in-out infinite;
}

/* ─── Skeleton shimmer ─── */
@layer utilities {
  .skeleton-shimmer {
    position: relative;
    overflow: hidden;
    background: var(--color-muted);
  }
  .skeleton-shimmer::after {
    content: "";
    position: absolute;
    inset: 0;
    background: linear-gradient(
      90deg,
      transparent 0%,
      color-mix(in oklch, var(--color-foreground) 8%, transparent) 50%,
      transparent 100%
    );
    animation: shimmer 1.8s ease-in-out infinite;
  }
}

/* ─── Keyframes ─── */
@keyframes shimmer {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(100%); }
}

@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-6px); }
}

@keyframes page-enter {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.page-enter {
  animation: page-enter 0.2s ease-out both;
}

@keyframes glow-pulse {
  0%, 100% { opacity: 0.6; }
  50% { opacity: 1; }
}

@keyframes scale-pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}

@keyframes mesh-drift-1 {
  0%, 100% { transform: translate(0, 0) scale(1); }
  33% { transform: translate(15%, -10%) scale(1.05); }
  66% { transform: translate(-10%, 15%) scale(0.95); }
}

@keyframes mesh-drift-2 {
  0%, 100% { transform: translate(0, 0) scale(1); }
  33% { transform: translate(-12%, -8%) scale(1.08); }
  66% { transform: translate(8%, 12%) scale(0.92); }
}

@keyframes mesh-drift-3 {
  0%, 100% { transform: translate(0, 0) scale(1); }
  25% { transform: translate(10%, -15%) scale(1.05); }
  50% { transform: translate(-15%, 5%) scale(0.95); }
  75% { transform: translate(5%, 10%) scale(1.02); }
}

/* ─── Scrollbar — themed, minimal ─── */
::-webkit-scrollbar {
  width: 6px;
  height: 6px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: color-mix(in srgb, var(--color-muted-foreground) 25%, transparent);
  border-radius: 9999px;
}

::-webkit-scrollbar-thumb:hover {
  background: color-mix(in srgb, var(--color-muted-foreground) 45%, transparent);
}

/* Hide scrollbar when not hovering (Webkit) */
::-webkit-scrollbar-thumb:not(:hover) {
  background: color-mix(in srgb, var(--color-muted-foreground) 15%, transparent);
}

/* Firefox scrollbar */
* {
  scrollbar-width: thin;
  scrollbar-color: color-mix(in srgb, var(--color-muted-foreground) 25%, transparent) transparent;
}

/* ─── Selection highlight ─── */
::selection {
  background: color-mix(in srgb, var(--color-primary) 30%, transparent);
  color: var(--color-foreground);
}
